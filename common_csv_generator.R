library(data.table)
setwd("D:/Data Science/gbt_benchmarks")

core_folder <- "new_core"
xeon_folder <- "new_xeon"

# file_reader syntax:
# - folder
# - threads
# - dataset
# - type
# - parameter value
# - CPU
# - eta
# - leaves
# - depth
# - hessian
# - subsample
# - colsample
file_reader <- list(list("xgb_gbt_lg",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "leaves",
                         sprintf("%04d", 2^(3:12) - 1),
                         "i7-7700K",
                         rep(0.02, 10),
                         2^(3:12) - 1,
                         rep(0, 10),
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "depth",
                         sprintf("%02d", 3:12),
                         "i7-7700K",
                         rep(0.02, 10),
                         2^(3:12) - 1,
                         3:12,
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "i7-7700K",
                         rep(0.02, 4),
                         rep(1023, 4),
                         rep(10, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "i7-7700K",
                         rep(0.04, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "depth",
                         sprintf("%02d", 3:12),
                         "i7-7700K",
                         rep(0.02, 10),
                         2^(3:12) - 1,
                         3:12,
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "i7-7700K",
                         rep(0.02, 4),
                         rep(1023, 4),
                         rep(10, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "i7-7700K",
                         rep(0.04, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", 8:1),
                         "higgs",
                         "leaves",
                         sprintf("%04d", 2^(3:12) - 1),
                         "i7-7700K",
                         rep(0.25, 10),
                         2^(3:12) - 1,
                         rep(0, 10),
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", 8:1),
                         "higgs",
                         "depth",
                         sprintf("%02d", 3:12),
                         "i7-7700K",
                         rep(0.25, 10),
                         2^(3:12) - 1,
                         3:12,
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", 8:1),
                         "higgs",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "i7-7700K",
                         rep(0.25, 4),
                         rep(1023, 4),
                         rep(10, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", 8:1),
                         "higgs",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "i7-7700K",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", 8:1),
                         "higgs",
                         "depth",
                         sprintf("%02d", 3:12),
                         "i7-7700K",
                         rep(0.25, 10),
                         2^(3:12) - 1,
                         3:12,
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", 8:1),
                         "higgs",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "i7-7700K",
                         rep(0.25, 4),
                         rep(1023, 4),
                         rep(10, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", 8:1),
                         "higgs",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "i7-7700K",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "depth",
                         sprintf("%02d", c(3, 6, 10)),
                         "i7-7700K",
                         rep(0.02, 3),
                         c(7, 63, 1023),
                         c(3, 6, 10),
                         rep(1, 3),
                         rep(1, 3),
                         rep(1, 3)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "hessian",
                         sprintf("%03d", c(1, 25)),
                         "i7-7700K",
                         rep(0.02, 2),
                         rep(1023, 2),
                         rep(10, 2),
                         c(1, 25),
                         rep(1, 2),
                         rep(1, 2)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "sampling",
                         sprintf("%.1f", c(1, 0.6)),
                         "i7-7700K",
                         rep(0.04, 2),
                         rep(63, 2),
                         rep(6, 2),
                         rep(1, 2),
                         c(1, 0.6),
                         rep(1, 2)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(8, 4)),
                         "higgs",
                         "depth",
                         sprintf("%02d", c(3, 6, 10)),
                         "i7-7700K",
                         rep(0.25, 3),
                         c(7, 63, 1023),
                         c(3, 6, 10),
                         rep(1, 3),
                         rep(1, 3),
                         rep(1, 3)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(8, 4)),
                         "higgs",
                         "hessian",
                         sprintf("%03d", c(1, 25)),
                         "i7-7700K",
                         rep(0.25, 2),
                         rep(1023, 2),
                         rep(10, 2),
                         c(1, 25),
                         rep(1, 2),
                         rep(1, 2)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(8, 4)),
                         "higgs",
                         "sampling",
                         sprintf("%.1f", c(1, 0.6)),
                         "i7-7700K",
                         rep(0.25, 2),
                         rep(63, 2),
                         rep(6, 2),
                         rep(1, 2),
                         c(1, 0.6),
                         rep(1, 2)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "leaves",
                         sprintf("%04d", 2^(3:7) - 1),
                         "i7-7700K",
                         rep(0.25, 5),
                         2^(3:7) - 1,
                         rep(0, 5),
                         rep(1, 5),
                         rep(1, 5),
                         rep(1, 5)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "depth",
                         sprintf("%02d", 3:7),
                         "i7-7700K",
                         rep(0.25, 5),
                         2^(3:7) - 1,
                         3:7,
                         rep(1, 5),
                         rep(1, 5),
                         rep(1, 5)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "i7-7700K",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "i7-7700K",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "depth",
                         sprintf("%02d", 3:7),
                         "i7-7700K",
                         rep(0.25, 5),
                         2^(3:7) - 1,
                         3:12,
                         rep(1, 5),
                         rep(1, 5),
                         rep(1, 5)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "i7-7700K",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "i7-7700K",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "depth",
                         sprintf("%02d", 6),
                         "i7-7700K",
                         0.25,
                         63,
                         6,
                         1,
                         1,
                         1),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "hessian",
                         sprintf("%03d", 25),
                         "i7-7700K",
                         0.25,
                         63,
                         6,
                         25,
                         1,
                         1),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "sampling",
                         sprintf("%.1f", 0.6),
                         "i7-7700K",
                         0.25,
                         63,
                         6,
                         1,
                         0.6,
                         1),
                    list("lgb_na",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "leaves",
                         sprintf("%04d", 2^(3:12) - 1),
                         "i7-7700K",
                         rep(0.02, 10),
                         2^(3:12) - 1,
                         rep(0, 10),
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("lgb_na",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "depth",
                         sprintf("%02d", 3:12),
                         "i7-7700K",
                         rep(0.02, 10),
                         2^(3:12) - 1,
                         3:12,
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("lgb_na",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "i7-7700K",
                         rep(0.02, 4),
                         rep(1023, 4),
                         rep(10, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("lgb_na",
                         sprintf("%02d", 8:1),
                         "bosch",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "i7-7700K",
                         rep(0.04, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("lgb_na",
                         sprintf("%02d", 8:1),
                         "higgs",
                         "leaves",
                         sprintf("%04d", 2^(3:12) - 1),
                         "i7-7700K",
                         rep(0.25, 10),
                         2^(3:12) - 1,
                         rep(0, 10),
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("lgb_na",
                         sprintf("%02d", 8:1),
                         "higgs",
                         "depth",
                         sprintf("%02d", 3:12),
                         "i7-7700K",
                         rep(0.25, 10),
                         2^(3:12) - 1,
                         3:12,
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("lgb_na",
                         sprintf("%02d", 8:1),
                         "higgs",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "i7-7700K",
                         rep(0.25, 4),
                         rep(1023, 4),
                         rep(10, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("lgb_na",
                         sprintf("%02d", 8:1),
                         "higgs",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "i7-7700K",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("lgb_na",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "leaves",
                         sprintf("%04d", 2^(3:7) - 1),
                         "i7-7700K",
                         rep(0.25, 5),
                         2^(3:7) - 1,
                         rep(0, 5),
                         rep(1, 5),
                         rep(1, 5),
                         rep(1, 5)),
                    list("lgb_na",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "depth",
                         sprintf("%02d", 3:7),
                         "i7-7700K",
                         rep(0.25, 5),
                         2^(3:7) - 1,
                         3:7,
                         rep(1, 5),
                         rep(1, 5),
                         rep(1, 5)),
                    list("lgb_na",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "i7-7700K",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("lgb_na",
                         sprintf("%02d", c(8, 4)),
                         "reput",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "i7-7700K",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "leaves",
                         sprintf("%04d", 2^(3:12) - 1),
                         "Dual Xeon",
                         rep(0.02, 10),
                         2^(3:12) - 1,
                         rep(0, 10),
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "depth",
                         sprintf("%02d", 3:12),
                         "Dual Xeon",
                         rep(0.02, 10),
                         2^(3:12) - 1,
                         3:12,
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "Dual Xeon",
                         rep(0.02, 4),
                         rep(1023, 4),
                         rep(10, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "Dual Xeon",
                         rep(0.04, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "depth",
                         sprintf("%02d", 3:12),
                         "Dual Xeon",
                         rep(0.02, 10),
                         2^(3:12) - 1,
                         3:12,
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "Dual Xeon",
                         rep(0.02, 4),
                         rep(1023, 4),
                         rep(10, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "Dual Xeon",
                         rep(0.04, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "higgs",
                         "leaves",
                         sprintf("%04d", 2^(3:12) - 1),
                         "Dual Xeon",
                         rep(0.25, 10),
                         2^(3:12) - 1,
                         rep(0, 10),
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "higgs",
                         "depth",
                         sprintf("%02d", 3:12),
                         "Dual Xeon",
                         rep(0.25, 10),
                         2^(3:12) - 1,
                         3:12,
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "higgs",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "Dual Xeon",
                         rep(0.25, 4),
                         rep(1023, 4),
                         rep(10, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "higgs",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "Dual Xeon",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "higgs",
                         "depth",
                         sprintf("%02d", 3:12),
                         "Dual Xeon",
                         rep(0.25, 10),
                         2^(3:12) - 1,
                         3:12,
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "higgs",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "Dual Xeon",
                         rep(0.25, 4),
                         rep(1023, 4),
                         rep(10, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "higgs",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "Dual Xeon",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "depth",
                         sprintf("%02d", c(3, 6, 10)),
                         "Dual Xeon",
                         rep(0.02, 3),
                         c(7, 63, 1023),
                         c(3, 6, 10),
                         rep(1, 3),
                         rep(1, 3),
                         rep(1, 3)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "hessian",
                         sprintf("%03d", c(1, 25)),
                         "Dual Xeon",
                         rep(0.02, 2),
                         rep(1023, 2),
                         rep(10, 2),
                         c(1, 25),
                         rep(1, 2),
                         rep(1, 2)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "sampling",
                         sprintf("%.1f", c(1, 0.6)),
                         "Dual Xeon",
                         rep(0.04, 2),
                         rep(63, 2),
                         rep(6, 2),
                         rep(1, 2),
                         c(1, 0.6),
                         rep(1, 2)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(40, 20)),
                         "higgs",
                         "depth",
                         sprintf("%02d", c(3, 6, 10)),
                         "Dual Xeon",
                         rep(0.25, 3),
                         c(7, 63, 1023),
                         c(3, 6, 10),
                         rep(1, 3),
                         rep(1, 3),
                         rep(1, 3)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(40, 20)),
                         "higgs",
                         "hessian",
                         sprintf("%03d", c(1, 25)),
                         "Dual Xeon",
                         rep(0.25, 2),
                         rep(1023, 2),
                         rep(10, 2),
                         c(1, 25),
                         rep(1, 2),
                         rep(1, 2)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(40, 20)),
                         "higgs",
                         "sampling",
                         sprintf("%.1f", c(1, 0.6)),
                         "Dual Xeon",
                         rep(0.25, 2),
                         rep(63, 2),
                         rep(6, 2),
                         rep(1, 2),
                         c(1, 0.6),
                         rep(1, 2)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(10, 5)),
                         "reput",
                         "leaves",
                         sprintf("%04d", 2^(3:7) - 1),
                         "Dual Xeon",
                         rep(0.25, 5),
                         2^(3:7) - 1,
                         rep(0, 5),
                         rep(1, 5),
                         rep(1, 5),
                         rep(1, 5)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(10, 5)),
                         "reput",
                         "depth",
                         sprintf("%02d", 3:7),
                         "Dual Xeon",
                         rep(0.25, 5),
                         2^(3:7) - 1,
                         3:7,
                         rep(1, 5),
                         rep(1, 5),
                         rep(1, 5)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(10, 5)),
                         "reput",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "Dual Xeon",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("xgb_gbt_lg",
                         sprintf("%02d", c(10, 5)),
                         "reput",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "Dual Xeon",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", c(10, 5)),
                         "reput",
                         "depth",
                         sprintf("%02d", 3:7),
                         "Dual Xeon",
                         rep(0.25, 5),
                         2^(3:7) - 1,
                         3:12,
                         rep(1, 5),
                         rep(1, 5),
                         rep(1, 5)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", c(10, 5)),
                         "reput",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "Dual Xeon",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("xgb_gbt_dw",
                         sprintf("%02d", c(10, 5)),
                         "reput",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "Dual Xeon",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(40, 20)),
                         "reput",
                         "depth",
                         sprintf("%02d", 6),
                         "Dual Xeon",
                         0.25,
                         63,
                         6,
                         1,
                         1,
                         1),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(40, 20)),
                         "reput",
                         "hessian",
                         sprintf("%03d", 25),
                         "Dual Xeon",
                         0.25,
                         63,
                         6,
                         25,
                         1,
                         1),
                    list("xgb_gbt_ex",
                         sprintf("%02d", c(40, 20)),
                         "reput",
                         "sampling",
                         sprintf("%.1f", 0.6),
                         "Dual Xeon",
                         0.25,
                         63,
                         6,
                         1,
                         0.6,
                         1),
                    list("lgb_na",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "leaves",
                         sprintf("%04d", 2^(3:12) - 1),
                         "Dual Xeon",
                         rep(0.02, 10),
                         2^(3:12) - 1,
                         rep(0, 10),
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("lgb_na",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "depth",
                         sprintf("%02d", 3:12),
                         "Dual Xeon",
                         rep(0.02, 10),
                         2^(3:12) - 1,
                         3:12,
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("lgb_na",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "Dual Xeon",
                         rep(0.02, 4),
                         rep(1023, 4),
                         rep(10, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("lgb_na",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "bosch",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "Dual Xeon",
                         rep(0.04, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("lgb_na",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "higgs",
                         "leaves",
                         sprintf("%04d", 2^(3:12) - 1),
                         "Dual Xeon",
                         rep(0.25, 10),
                         2^(3:12) - 1,
                         rep(0, 10),
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("lgb_na",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "higgs",
                         "depth",
                         sprintf("%02d", 3:12),
                         "Dual Xeon",
                         rep(0.25, 10),
                         2^(3:12) - 1,
                         3:12,
                         rep(1, 10),
                         rep(1, 10),
                         rep(1, 10)),
                    list("lgb_na",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "higgs",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "Dual Xeon",
                         rep(0.25, 4),
                         rep(1023, 4),
                         rep(10, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("lgb_na",
                         sprintf("%02d", c(40, 20, 10, 5, 4, 3, 2, 1)),
                         "higgs",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "Dual Xeon",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)),
                    list("lgb_na",
                         sprintf("%02d", c(40, 20)),
                         "reput",
                         "leaves",
                         sprintf("%04d", 2^(3:7) - 1),
                         "Dual Xeon",
                         rep(0.25, 5),
                         2^(3:7) - 1,
                         rep(0, 5),
                         rep(1, 5),
                         rep(1, 5),
                         rep(1, 5)),
                    list("lgb_na",
                         sprintf("%02d", c(40, 20)),
                         "reput",
                         "depth",
                         sprintf("%02d", 3:7),
                         "Dual Xeon",
                         rep(0.25, 5),
                         2^(3:7) - 1,
                         3:7,
                         rep(1, 5),
                         rep(1, 5),
                         rep(1, 5)),
                    list("lgb_na",
                         sprintf("%02d", c(40, 20)),
                         "reput",
                         "hessian",
                         sprintf("%03d", 5^(0:3)),
                         "Dual Xeon",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         5^(0:3),
                         rep(1, 4),
                         rep(1, 4)),
                    list("lgb_na",
                         sprintf("%02d", c(40, 20)),
                         "reput",
                         "sampling",
                         sprintf("%.1f", (5:2) / 5),
                         "Dual Xeon",
                         rep(0.25, 4),
                         rep(63, 4),
                         rep(6, 4),
                         rep(1, 4),
                         (5:2) / 5,
                         rep(1, 4)))

common_core_read <- data.table(Iteration = numeric(0),
                               Time = numeric(0),
                               AUC = numeric(0),
                               TimeDelta = numeric(0),
                               AUCDelta = numeric(0),
                               TimeAvg = numeric(0),
                               AUCAvg = numeric(0),
                               IterPerc = numeric(0),
                               Join = character(0),
                               Algorithm = character(0),
                               CPU = character(0))
common_core_dumbo <- data.table(Join = character(0),
                                Algorithm = character(0),
                                Dataset = character(0),
                                Variable = character(0),
                                Var_Name = character(0),
                                Best_Iter = numeric(0),
                                Best_AUC = numeric(0),
                                AUC_Time = numeric(0),
                                Total_Time = numeric(0),
                                Iterations = numeric(0),
                                CPU = character(0),
                                Threads = character(0),
                                Parameter = numeric(0),
                                Eta = numeric(0),
                                Leaves = numeric(0),
                                Depth = numeric(0),
                                Hessian = numeric(0),
                                Subsample = numeric(0),
                                Colsample = numeric(0))
err_cor <- 0

# Per element
for (i in file_reader) {
  
  common_core_read_mini <- data.table(Iteration = numeric(0),
                                      Time = numeric(0),
                                      AUC = numeric(0),
                                      TimeDelta = numeric(0),
                                      AUCDelta = numeric(0),
                                      TimeAvg = numeric(0),
                                      AUCAvg = numeric(0),
                                      IterPerc = numeric(0),
                                      Join = character(0),
                                      Algorithm = character(0),
                                      CPU = character(0))
  common_core_dumbo_mini <- data.table(Join = character(0),
                                       Algorithm = character(0),
                                       Dataset = character(0),
                                       Variable = character(0),
                                       Var_Name = character(0),
                                       Best_Iter = numeric(0),
                                       Best_AUC = numeric(0),
                                       AUC_Time = numeric(0),
                                       Total_Time = numeric(0),
                                       Iterations = numeric(0),
                                       CPU = character(0),
                                       Threads = character(0),
                                       Parameter = numeric(0),
                                       Eta = numeric(0),
                                       Leaves = numeric(0),
                                       Depth = numeric(0),
                                       Hessian = numeric(0),
                                       Subsample = numeric(0),
                                       Colsample = numeric(0))
  
  # Per thread
  for (j in i[[2]]) {
    
    l <- 0
    
    # Per parameter
    for (k in i[[5]]) {
      
      l <- l + 1
      err_temp <- 0
      err_nest <- 0
      
      temp_join1 <- i[[1]]
      temp_join2 <- paste0(j, "t_", i[[3]], "_", i[[4]], "_", k)
      temp_read <- fread(paste0(ifelse(i[[6]] == "i7-7700K", core_folder, xeon_folder), "/", temp_join1, "/", temp_join2, ".txt"), colClasses = rep("numeric", 3))
      temp_read$Time <- (temp_read$Time - temp_read$Time[1]) * 1000
      repeat {
        whatever <- which(temp_read$Time[2:nrow(temp_read)] < temp_read$Time[1:(nrow(temp_read) - 1)])
        if (length(whatever) > 0) {
          temp_read$Time[whatever + 1] <- temp_read$Time[whatever]
          err_temp <- err_temp + length(whatever)
          err_nest <- err_nest + 1
        } else {
          err_cor <- err_cor + err_temp
          break
        }
      }
      temp_read$AUC <- temp_read$AUC * 1000000
      temp_read$TimeDelta <- c(0, temp_read$Time[2:nrow(temp_read)] - temp_read$Time[1:(nrow(temp_read) - 1)])
      temp_read$AUCDelta <- c(0, temp_read$AUC[2:nrow(temp_read)] - c(0.5 * 1000000, temp_read$AUC[2:(nrow(temp_read) - 1)]))
      temp_read$TimeAvg <- c(0, cumsum(temp_read$TimeDelta[2:nrow(temp_read)]) / (temp_read$Iteration[2:nrow(temp_read)] - 1))
      temp_read$AUCAvg <- c(0, cumsum(temp_read$AUCDelta[2:nrow(temp_read)]) / (temp_read$Iteration[2:nrow(temp_read)] - 1))
      temp_read$IterPerc <- temp_read$Iteration / nrow(temp_read)
      temp_read$Join <- temp_join2
      temp_read$Algorithm <- temp_join1
      temp_read$CPU <- i[[6]]
      common_core_read_mini <- rbind(common_core_read_mini, temp_read)
      common_core_dumbo_mini <- rbind(common_core_dumbo_mini, data.table(Join = temp_join2,
                                                                         Algorithm = temp_join1,
                                                                         Dataset = i[[3]],
                                                                         Variable = i[[4]],
                                                                         Var_Name = paste0(toupper(substr(i[[4]], 1, 1)), substr(i[[4]], 2, nchar(i[[4]])), ": ", i[[5]][l]),
                                                                         Best_Iter = which.max(temp_read$AUC)[1],
                                                                         Best_AUC = max(temp_read$AUC),
                                                                         AUC_Time = temp_read$Time[which.max(temp_read$AUC)[1]],
                                                                         Total_Time = temp_read$Time[nrow(temp_read)],
                                                                         Iterations = nrow(temp_read),
                                                                         CPU = i[[6]],
                                                                         Threads = j,
                                                                         Parameter = k,
                                                                         Eta = i[[7]][l],
                                                                         Leaves = i[[8]][l],
                                                                         Depth = i[[9]][l],
                                                                         Hessian = i[[10]][l],
                                                                         Subsample = i[[11]][l],
                                                                         Colsample = i[[12]][l]))
      cat(temp_join1, "/", temp_join2, ifelse(err_temp > 0, paste0(": ERROR CORRECTED (nest of ", err_nest, ": ", err_temp, " out of ", err_cor, ") ***"), ": PASS"), "\n")
      
    }
    
  }
  
  common_core_read <- rbind(common_core_read, common_core_read_mini)
  common_core_dumbo <- rbind(common_core_dumbo, common_core_dumbo_mini)
  
}

common_core_dumbo$Eta <- as.character(common_core_dumbo$Eta)
common_core_dumbo$Leaves <- as.character(common_core_dumbo$Leaves)
common_core_dumbo$Depth <- as.character(common_core_dumbo$Depth)
common_core_dumbo$Hessian <- as.character(common_core_dumbo$Hessian)
common_core_dumbo$Subsample <- as.character(common_core_dumbo$Subsample)
common_core_dumbo$Colsample <- as.character(common_core_dumbo$Colsample)

# Export
fwrite(common_core_dumbo, "common_core_dumbo.csv")
fwrite(common_core_read, "common_core_read.csv")
